# 07/31 ê¸°ìˆ  ìŠ¤í„°ë””

ì‘ì„± ì¼ì‹œ: 2024ë…„ 7ì›” 31ì¼ ì˜¤í›„ 6:13
ìµœì¢… í¸ì§‘ ì¼ì‹œ: 2024ë…„ 7ì›” 31ì¼ ì˜¤í›„ 7:55
ì‘ì„±ì: ì¬ìš± ê¹€
ì°¸ì„ì: ì¬ìš± ê¹€, ëª…í›ˆ, ê¹€ì§„ì˜
ìƒíƒœ: Backlog

## ì´ë²ˆì‹œê°„

- [Jest / Vitest ë¥¼ í™œìš©í•œ React í…ŒìŠ¤íŒ… ë¼ì´ë¸ŒëŸ¬ë¦¬](https://www.udemy.com/course/jest-testing-library/)
- ë§ˆë¬´ë¦¬.

- ëª…í›ˆ
    
    ## í† í•‘ ì—…ë°ì´íŠ¸ í…ŒìŠ¤íŠ¸
    
    ```jsx
    test("update toppings subtotal when toppings change", async () => {
      const user = userEvent.setup();
      render(<Options optionType={"toppings"} />);
    
      // make sure total starts out at 0.00
      const toppingsTotal = screen.getByText("Toppings total: $", { exact: false });
      expect(toppingsTotal).toHaveTextContent("0.00");
    
      // add cherries and check subtotal
      const cherriesCheckbox = await screen.findByRole("checkbox", {
        name: "Cherries"
      })
      await user.click(cherriesCheckbox);
      expect(toppingsTotal).toHaveTextContent("1.50");
    
      // add hot fudge and check subtotal
      const hotFudgeCheckbox  = screen.getByRole("checkbox", {name: "Hot fudge"})
      await user.click(hotFudgeCheckbox)
      expect(toppingsTotal).toHaveTextContent("3.00");
    
      // remove hot fudge and check subtotal
      await user.click(hotFudgeCheckbox);
      expect(toppingsTotal).toHaveTextContent("1.50");
    
    });
    ```
    
    ## ì „ì²´ ì´í•© ì—…ë°ì´íŠ¸ í…ŒìŠ¤íŠ¸
    
    ```jsx
    describe("grand total", () => {
      test("grand total starts at $0.00", () => {
        render(<OrderEntry />);
        const grandTotal = screen.getByRole("heading", { name: /Grand total: \$/ });
        expect(grandTotal).toHaveTextContent("0.00");
      });
    
      test("grand total updates properly if scoop is added first", async () => {
        const user = userEvent.setup();
        render(<OrderEntry />);
        const grandTotal = screen.getByRole("heading", { name: /Grand total: \$/ });
    
        const vanillaInput = await screen.findByRole("spinbutton", {
          name: "Vanilla",
        });
    
        await user.clear(vanillaInput);
        await user.type(vanillaInput, "2");
        expect(grandTotal).toHaveTextContent("4.00");
    
        const cherriesCheckbox = await screen.findByRole("checkbox", {
          name: "Cherries",
        });
        await user.click(cherriesCheckbox);
        expect(grandTotal).toHaveTextContent("5.50");
      });
    
      test("grand total updates properly if topping is added first", async () => {
        const user = userEvent.setup();
        render(<OrderEntry />);
        const grandTotal = screen.getByRole("heading", { name: /Grand total: \$/ });
    
        const cherriesCheckbox = await screen.findByRole("checkbox", {
          name: "Cherries",
        });
        await user.click(cherriesCheckbox);
    
        expect(grandTotal).toHaveTextContent("1.50");
    
        const vanillaInput = await screen.findByRole("spinbutton", {
          name: "Vanilla",
        });
    
        await user.clear(vanillaInput);
        await user.type(vanillaInput, "2");
        expect(grandTotal).toHaveTextContent("5.50");
      });
    
      test("grand total updates properly if item is removed", async () => {
        const user = userEvent.setup();
        render(<OrderEntry />);
    
        const cherriesCheckbox = await screen.findByRole("checkbox", {
          name: "Cherries",
        });
        await user.click(cherriesCheckbox);
    
        const vanillaInput = await screen.findByRole("spinbutton", {
          name: "Vanilla",
        });
    
        await user.clear(vanillaInput);
        await user.type(vanillaInput, "2");
    
        await user.clear(vanillaInput);
        await user.type(vanillaInput, "1");
    
        const grandTotal = screen.getByRole("heading", { name: /Grand total: \$/ });
        expect(grandTotal).toHaveTextContent("3.50");
      });
    });
    ```
    
    ## Not wrapped in act() ì—ëŸ¬
    
    test ë¥¼ ìœ„í•´ ì»´í¬ë„ŒíŠ¸ê°€ ë§ˆìš´íŠ¸ë˜ê³  ê·¸ ì»´í¬ë„ŒíŠ¸ì— ì—°ê²°ëœ ë¹„ë™ê¸° í†µì‹ ì´ ì‹¤í–‰ë˜ëŠ”ë° ì´ ë¹„ë™ê¸° í†µì‹ ì´ ëë‚˜ê¸° ì „ì— í…ŒìŠ¤íŠ¸ê°€ ë‹¤ ì´ë¤„ì ¸ì„œ ì»´í¬ë„ŒíŠ¸ê°€ ì–¸ë§ˆìš´íŠ¸ ë˜ë©´ ë°œìƒí•˜ëŠ” ì—ëŸ¬ 
    
    ### ì‘ì—…ê³¼ ë¹„ë™ê¸° í†µì‹ ì´ ëë‚˜ëŠ” ì‘ì—… ì‚¬ì´ì˜ ê²½í•© ìƒíƒœ ë•Œë¬¸
    
    <aside>
    ğŸ’¡ ì´ ì—ëŸ¬ë¥¼ ë§‰ê¸° ìœ„í•´ì„œëŠ” ë¹„ë™ê¸° í†µì‹  ì½”ë“œì— ì»´í¬ë„ŒíŠ¸ê°€ ì–¸ë§ˆìš´íŠ¸ ë˜ë©´ í†µì‹ ì„ ì¢…ë£Œí•˜ë¼ëŠ” ì½”ë“œë¥¼ ë„£ìœ¼ë©´ ë¨
    
    </aside>
    
    Option.jsxì— ë‹¤ìŒì˜ Abortcontroller ì¶”ê°€ 
    
    ```jsx
    
      useEffect(() => {
        // create an abortController to attach to network request
        const controller = new AbortController();
        axios
          .get(`http://localhost:3030/${optionType}`, { signal: controller.signal })
          .then((response) => setItems(response.data))
          .catch(() => setError(true));
    
        // abort axios call on component unmount
        return () => {
          controller.abort();
        };
      }, [optionType]);
    
    ```
    
    ë¬¸ì œê°€ ë˜ëŠ” totalUpdates.test ì•ˆ grand total starts at $0.00 í…ŒìŠ¤íŠ¸ ì—ì„œ 
    
    ```jsx
      test("grand total starts at $0.00", () => {
        const { unmount } = render(<OrderEntry />);
        const grandTotal = screen.getByRole("heading", { name: /Grand total: \$/ });
        expect(grandTotal).toHaveTextContent("0.00");
    
        unmount();
      });
    ```
    
    ## ìˆ˜ë™ ì¸ìˆ˜ (Acceptance) í…ŒìŠ¤íŠ¸
    
    - sundae-server ì—ì„œ npm startë¡œ í¬íŠ¸ 3030ì—ì„œ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸
    - sundae-starterì—ì„œ npm run dev ë¡œ 3000í¬íŠ¸ì—ì„œ í”„ë¡ íŠ¸ ì‹¤í–‰
    
    # ìµœì¢… ì‹œí—˜ : ì£¼ë¬¸ ë‹¨ê³„
    
    ### í…ŒìŠ¤íŠ¸ ë‚´ìš©
    
    ```jsx
    test('Order phases for happy path', () => {
      // render app
    
      // add ice cream scoops and toppings
    
      // find and click order button 
    
      // check summary information based on order
    
      // accept terms and conditions and click button to confirm order 
    
      // confirm order number on confirmation page
    
      // click 'new order' button on confirmation page 
    
      // check that scoops and toppings subtotals have been reset 
      
      // do we need to await anything to avoid test errors? 
    })
    ```
    
    ### post ìš”ì²­ msw ë¡œ mock í•˜ê¸°
    
    ```jsx
    import { delay, http, HttpResponse } from "msw";
    
    export const handlers = [
      http.get("http://localhost:3030/scoops", () => {
        return HttpResponse.json([
          { name: "Chocolate", imagePath: "/images/chocolate.png" },
          { name: "Vanilla", imagePath: "/images/Vanilla.png" },
        ]);
      }),
      http.get("http://localhost:3030/toppings", () => {
        return HttpResponse.json([
          { name: "Cherries", imagePath: "/images/Cherries.png" },
          { name: "M&Ms", imagePath: "/images/M-and-ms.png" },
          { name: "Hot fudge", imagePath: "/images/hot-fundge.png" },
        ]);
      }),
      http.post("http://localhost:3030/order", async () => {
        await delay(100);
        return HttpResponse.json({ orderNumber: 123145476 }, { status: 201 });
      }),
    ];
    
    ```
    
    ### Debugging Tips
    
    - screen.debug() : íŠ¹ì •ìš”ì†Œë¥¼ ì°¾ê±°ë‚˜ ì°¾ì§€ ëª»í•  ë•Œ
    - logRoles
    - await findBy*ë¥¼ ì¨ì•¼í•˜ëŠ” ìƒí™©ì— getByë¥¼ ì“°ëŠ”ì§€
    - userEventì— await ë¥¼ ì‚¬ìš©í•˜ê³  ìˆëŠ”ì§€
    - test ì•„ì›ƒí’‹ì˜ error ì˜ ì½ê¸°
    
    ## ìµœì¢… í…ŒìŠ¤íŠ¸
    
    ```jsx
    
    test("Order phases for happy path", async () => {
      const user = userEvent.setup();
      // render app
      // Don't need to wrap in provider : already wrapped!
    
      // destructure 'unmount' from return value to use at the end of the test
      const { unmount } = render(<App />);
      
      App ì»´í¬ë„ŒíŠ¸ return ë¬¸ 
      return (
        <OrderDetailsProvider>
          <Container>{<Component setOrderPhase={setOrderPhase} />}</Container>
        </OrderDetailsProvider>
      );
      
      // add ice cream scoops and toppings
      const vanillaInput = await screen.findByRole("spinbutton", {
        name: "Vanilla",
      });
      await user.clear(vanillaInput);
      await user.type(vanillaInput, "1");
    
      // ë°”ë‹ë¼ë¥¼ ì°¾ì•˜ìœ¼ë©´ ì´ˆì½”ë ›ì€ ìˆë‹¤ëŠ” ë§ì´ë‹ˆê¹Œ find ë¥¼ ì“¸ í•„ìš”ì—†ë‹¤.
      const chocolateInput = screen.getByRole("spinbutton", { name: "Chocolate" });
      await user.clear(chocolateInput);
      await user.type(chocolateInput, "2");
    
      // add ice cream scoops and toppings
      const cherriesCheckbox = await screen.findByRole("checkbox", {
        name: "Cherries",
      });
      await user.click(cherriesCheckbox);
    
      // find and click order summary button
      const orderSummaryButton = screen.getByRole("button", {
        name: /order sundae/i,
      });
      await user.click(orderSummaryButton);
    
      // check summary information based on order
    
      const summaryHeading = screen.getByRole("heading", { name: "Order Summary" });
      expect(summaryHeading).toBeInTheDocument();
    
      const scoopsHeading = screen.getByRole("heading", { name: "Scoops: $6.00" });
      expect(scoopsHeading).toBeInTheDocument();
    
      const toppingsHeading = screen.getByRole("heading", {
        name: "Toppings: $1.50",
      });
      expect(toppingsHeading).toBeInTheDocument();
    
      expect(screen.getByText("1 Vanilla")).toBeInTheDocument();
      expect(screen.getByText("2 Chocolate")).toBeInTheDocument();
      expect(screen.getByText("Cherries")).toBeInTheDocument();
    
      // accept terms and conditions and click button to confirm order
      const tcCheckbox = screen.getByRole("checkbox", {
        name: /terms and conditions/i,
      });
      await user.click(tcCheckbox);
    
      const confirmOrderButton = screen.getByRole("button", {
        name: /confirm order/i,
      });
      await user.click(confirmOrderButton);
    
      const loading = screen.getByText(/loading/i);
      expect(loading).toBeInTheDocument();
    
      // confirm order number on confirmation page
      const thankYouHeader = await screen.findByRole("heading", {
        name: /thank you/i,
      });
      expect(thankYouHeader).toBeInTheDocument();
    
      const notLoading = screen.queryByText("loading");
      expect(notLoading).not.toBeInTheDocument();
    
      const orderNumber = await screen.findByText(/order number/i);
      expect(orderNumber).toBeInTheDocument();
    
      // click 'new order' button on confirmation page
      const newOrderButton = screen.getByRole("button", { name: /new order/i });
      await user.click(newOrderButton);
    
      // check that scoops and toppings subtotals have been reset
      const scoopsTotal = await screen.findByText("Scoops total: $0.00");
      expect(scoopsTotal).toBeInTheDocument();
    
      const toppingsTotal = screen.getByText("Toppings total: $0.00");
      expect(toppingsTotal).toBeInTheDocument();
    
      // do we need to await anything to avoid test errors?
      unmount();
    });
    
    ```
    

## ë‹¤ìŒ ì‹œê°„ :   8/7 ìˆ˜  ì €ë… 7ì‹œ

- [Jest / Vitest ë¥¼ í™œìš©í•œ React í…ŒìŠ¤íŒ… ë¼ì´ë¸ŒëŸ¬ë¦¬](https://www.udemy.com/course/jest-testing-library/)
- ì„ íƒì  ì¶”ê°€ì—°ìŠµê¹Œì§€ ë³´ê³ ì˜¤ê¸°.
    - ì·¨ì—…ì„ ìœ„í•œ ë‹¤ìŒ ìŠ¤íƒ­
    - ê°œë°œ ì‹¤ë ¥ í–¥ìƒì„ ìœ„í•œ ë‹¤ìŒ ìŠ¤íƒ­
- ë‹¤ìŒ ìŠ¤í„°ë”” ì£¼ì œ ìƒê°í•´ì˜¤ê¸°.